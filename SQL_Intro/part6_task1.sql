--Часть 6. Задача 1. Добавление колонки с суммой всех заказов клиента
SELECT 
	order_id,	-- ID заказа
	customer_id,	-- ID клиента
	item,	-- Наименование товара
	amount,	-- Стоимость товара
		-- Оконная функция: сумма всех заказов по текущему клиенту
	SUM(amount) OVER (
		PARTITION BY customer_id	-- Деление на группы по клиентам
	) AS total_by_customer	-- Общая сумма всех заказов клиента
FROM orders	-- Основной источник данных (заказы)
ORDER BY order_id	-- Сортировка результатлв по ID заказа